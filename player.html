<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="light">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>مشغل القرآن — Quran Player</title>
    <meta name="description" content="مشغل قرآن بسيط: اختر السورة والقارئ وسيتم تشغيل التلاوة مع إبراز الآية الحالية.">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <!-- Main CSS -->
    <link rel="stylesheet" href="styles/main.css">


</head>

<body>

    <!-- Top Navigation - Desktop Only -->
    <nav class="navbar navbar-expand-lg fixed-top d-none d-md-block">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <img src="media/images/logo.jpg" alt="Quran Cast Logo" width="40" height="40" class="rounded me-3">
            </a>

            <!-- Navigation Links -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">
                            <i class="bi me-2"></i> الرئيسية
                        </a>
                    </li>


                    <li class="nav-item">
                        <a class="nav-link" href="prayer-qibla.html">
                            <i class="bi me-2"></i>الصلاة والقبلة
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link active" href="player.html">
                            <i class="bi me-2"></i>القرآن الكريم
                        </a>
                    </li>


                    <li class="nav-item">
                        <a class="nav-link" href="hadith.html">
                            <i class="bi me-2"></i>الأحاديث
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="mushaf.html">
                            <i class="bi bi-journal-text me-2"></i>المصحف
                        </a>
                    </li>
                </ul>

                <!-- Theme Toggle -->
                <div class="navbar-nav">
                    <button class="btn theme-toggle" onclick="toggleTheme()" title="تبديل الوضع المظلم">
                        <i class="bi bi-moon-fill" id="themeIcon"></i>
                    </button>
                </div>

            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>
    <aside class="sidebar enhanced-sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3 class="sidebar-title">القائمة</h3>
        </div>
        <nav class="sidebar-nav">
            <div class="sidebar-nav-item">
                <a href="index.html">
                    <i class="bi bi-house"></i>
                    <span>الرئيسية</span>
                </a>
            </div>
            <div class="sidebar-nav-item active">
                <a href="player.html">
                    <i class="bi bi-play-circle"></i>
                    <span>المشغل</span>
                </a>
            </div>
            <div class="sidebar-nav-item">
                <a href="reading.html">
                    <i class="bi bi-book"></i>
                    <span>القراءة</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="prayer-qibla.html">
                    <i class="bi bi-compass"></i>
                    <span>الصلاة والقبلة</span>
                </a>
            </div>
            <div class="sidebar-nav-item">
                <a href="hadith.html">
                    <i class="bi bi-chat-quote"></i>
                    <span>الأحاديث</span>
                </a>
            </div>
            <div class="sidebar-nav-item">
                <a href="mushaf.html">
                    <i class="bi bi-journal-text"></i>
                    <span>المصحف</span>
                </a>
            </div>
        </nav>
    </aside>

    <!-- Top Navigation Bar (Mobile) -->
    <nav class="top-navbar">
        <div class="nav-item" onclick="window.location.href='index.html'">
            <i class="bi bi-house"></i>
            <span>الرئيسية</span>
        </div>
        <div class="nav-item active" onclick="window.location.href='player.html'">
            <i class="bi bi-play-circle"></i>
            <span>المشغل</span>
        </div>
        <div class="nav-item" onclick="window.location.href='reading.html'">
            <i class="bi bi-book"></i>
            <span>القراءة</span>
        </div>
        <div class="nav-item" onclick="window.location.href='hadith.html'">
            <i class="bi bi-chat-quote"></i>
            <span>الأحاديث</span>
        </div>
        <div class="nav-item" onclick="window.location.href='mushaf.html'">
            <i class="bi bi-journal-text"></i>
            <span>المصحف</span>
        </div>
        <div class="nav-item" onclick="window.location.href='prayer-qibla.html'">
            <i class="bi bi-compass"></i>
            <span>الصلاة</span>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="player-header">
            <div class="text-center mb-3">
                <h1 class="display-6 text-white mb-2">
                    <i class="bi bi-play-circle-fill me-3"></i>
                    مشغل القرآن الكريم
                </h1>
                <p class="text-white-50 mb-0">استمع إلى تلاوات عطرة من القرآن الكريم</p>
            </div>

            <div class="player-controls">
                <select id="reciterSelect" class="form-select" title="اختر القارئ"></select>
                <input id="surahSearch" class="form-control" placeholder="ابحث عن سورة بالاسم (الفاتحة، البقرة...)" />
                <select id="surahSelect" class="form-select" title="اختر السورة"></select>
            </div>

            <div class="player-interface">
                <button id="prevBtn" class="btn btn-outline-primary" title="الآية السابقة">
                    <i class="bi bi-skip-backward"></i>
                    السابق
                </button>
                <button id="playPauseBtn" class="btn btn-primary" title="تشغيل/إيقاف">
                    <i class="bi bi-play-fill" id="playIcon"></i>
                    تشغيل
                </button>
                <button id="nextBtn" class="btn btn-outline-primary" title="الآية التالية">
                    <i class="bi bi-skip-forward"></i>
                    التالي
                </button>
                <button id="showTafsirMain" class="btn btn-outline-secondary" onclick="toggleTafsir()"
                    title="إظهار/إخفاء التفسير">
                    <i class="bi bi-book-open"></i>
                    التفسير
                </button>
                <span id="playStatus" class="player-status">جاهز</span>
            </div>
        </div>

        <div class="two-col">
            <section>
                <div class="now">
                    <div class="text-center mb-4">
                        <div class="surah-name" id="currentSurah">—</div>
                        <div class="ayah-meta" id="ayahMeta">—</div>
                    </div>
                    <div class="ayah-text" id="currentAyah">اختر سورة ثم اضغط تشغيل…</div>
                </div>

                <!-- Current Ayah Details -->
                <div class="ayah-details">
                    <!-- Tafsir Section -->
                    <div class="tafsir-section">
                        <div class="tafsir-header">
                            <h4>
                                <i class="bi bi-book-open me-2"></i>التفسير
                            </h4>
                        </div>
                        <div class="tafsir-text" id="tafsirText">
                            اختر سورة لعرض التفسير...
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="text-center">
            <p class="mb-2">
                <i class="bi bi-heart-fill text-danger me-2"></i>
                تم تطوير هذا التطبيق بحب وإخلاص لخدمة القرآن الكريم
            </p>
            <p class="mb-0 text-muted">
                <small>
                    <i class="bi bi-info-circle me-1"></i>
                    جميع التلاوات من API القرآن الكريم | التفسير من المصدر: الميسر
                </small>
            </p>
        </div>
    </footer>

    <audio id="audio" preload="none"></audio>

    <script>
        // خريطة القراء إلى أكواد الإصدارات (editions) في API

        const RECITERS = [
            { name: 'مشاري راشد العفاسي', code: 'ar.alafasy' },
            { name: 'عبد الباسط عبد الصمد (مرتل)', code: 'ar.abdulbasitmurattal' },
            { name: 'عبد الباسط عبد الصمد (مجود)', code: 'ar.abdulbasitmujawwad' },
            { name: 'محمد صديق المنشاوي (مرتل)', code: 'ar.minshawi' },
            { name: 'محمد صديق المنشاوي (مجود)', code: 'ar.minshawimujawwad' },
            { name: 'عبد الرحمن السديس', code: 'ar.abdurrahmaansudais' },
            { name: 'محمود خليل الحصري (مرتل)', code: 'ar.husary' },
            { name: 'محمود خليل الحصري (مجود)', code: 'ar.husarymujawwad' },
            { name: 'سعود الشريم', code: 'ar.saoodshuraym' },
            { name: 'محمد أيوب', code: 'ar.muhammadayyoub' },
            { name: ' ابو بكر الشاطري', code: 'ar.shaatree' },
            { name: '  احمد بن علي العجمي', code: 'ar.ahmedajamy' },
            { name: ' ماهر المعيقلي', code: 'ar.ahmedajamy' },





        ];



        // عناصر DOM
        const reciterSelect = document.getElementById('reciterSelect');
        const surahSelect = document.getElementById('surahSelect');
        const surahSearch = document.getElementById('surahSearch');
        const currentSurah = document.getElementById('currentSurah');
        const currentAyah = document.getElementById('currentAyah');
        const ayahMeta = document.getElementById('ayahMeta');
        const playStatus = document.getElementById('playStatus');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const audioEl = document.getElementById('audio');
        const tafsirText = document.getElementById('tafsirText');
        const showTafsirMainBtn = document.getElementById('showTafsirMain');

        let surahs = [];        // قائمة السور
        let ayahs = [];         // آيات السورة المختارة
        let currentAyahIndex = 0;
        let autoPlayEnabled = true; // تفعيل التشغيل التلقائي
        let isTafsirVisible = true; // حالة التفسير (ظاهر أم غائب)

        // تعبئة قائمة القرّاء
        function initReciters() {
            reciterSelect.innerHTML = RECITERS
                .map((r, i) => `<option value="${r.code}" ${i === 0 ? 'selected' : ''}>${r.name}</option>`)
                .join('');
        }

        // جلب قائمة السور
        async function loadSurahs() {
            try {
                const res = await fetch('https://api.alquran.cloud/v1/surah');
                const json = await res.json();
                if (json.status === 'OK') {
                    surahs = json.data; // [{number, name, englishName, englishNameTranslation, numberOfAyahs, revelationType}]
                }
            } catch (err) {
                console.warn('تعذر جلب السور من API. سيتم بناء قائمة احتياطية.', err);
                surahs = Array.from({ length: 114 }, (_, i) => ({ number: i + 1, name: `سورة ${i + 1}` }));
            }
            renderSurahOptions();

            // تحقق من وجود سورة مختارة من الصفحة الرئيسية
            checkForSelectedSurah();
        }

        // تحقق من وجود سورة مختارة من الصفحة الرئيسية
        function checkForSelectedSurah() {
            const selectedSurah = localStorage.getItem('qc-selected-surah');
            if (selectedSurah) {
                try {
                    const surahData = JSON.parse(selectedSurah);
                    console.log('تم العثور على سورة مختارة:', surahData);

                    // تعيين السورة المختارة
                    surahSelect.value = surahData.number;

                    // تحميل السورة
                    selectSurah(surahData.number, true);

                    // مسح البيانات من localStorage
                    localStorage.removeItem('qc-selected-surah');
                } catch (error) {
                    console.error('خطأ في قراءة بيانات السورة المختارة:', error);
                }
            }
        }

        function renderSurahOptions() {
            surahSelect.innerHTML = surahs.map(s => `<option value="${s.number}">${s.number}. ${s.name}</option>`).join('');
        }

        surahSelect.addEventListener('change', () => selectSurah(Number(surahSelect.value), true));
        reciterSelect.addEventListener('change', () => selectSurah(Number(surahSelect.value), true));

        async function selectSurah(num, autoPlay = false) {
            if (!num) return;
            const reciterCode = reciterSelect.value;
            playStatus.textContent = 'جاري تحميل السورة…';
            currentSurah.textContent = '—';
            currentAyah.textContent = '—';
            ayahMeta.textContent = '—';
            tafsirText.textContent = 'جاري التحميل...';

            try {
                // مثال: https://api.alquran.cloud/v1/surah/1/ar.alafasy
                const url = `https://api.alquran.cloud/v1/surah/${num}/${reciterCode}`;
                const res = await fetch(url);
                const json = await res.json();
                if (json.status !== 'OK') throw new Error('API error');
                const data = json.data;
                ayahs = data.ayahs.map((a, idx) => ({
                    numberInSurah: a.numberInSurah,
                    text: a.text,
                    audio: a.audio,
                    juz: a.juz,
                    hizbQuarter: a.hizbQuarter,
                    sajda: a.sajda
                }));

                currentSurah.textContent = `${data.number}. ${data.name}`;
                currentAyahIndex = 0;
                highlightAyah(currentAyahIndex, { center: false });
                playStatus.textContent = `تم تحميل ${ayahs.length} آية`;

                // التشغيل التلقائي إذا كان مفعلاً
                if (autoPlay && autoPlayEnabled && ayahs.length > 0) {
                    // تأخير قصير للتأكد من تحميل الصوت
                    setTimeout(() => {
                        playAyah(0);
                        showAutoPlayNotification();
                    }, 1000);
                }
            } catch (err) {
                console.error(err);
                playStatus.textContent = 'تعذر تحميل السورة. تحقق من الاتصال أو جرّب قارئًا آخر.';
                tafsirText.textContent = 'تعذر التحميل';
            }
        }

        // إظهار إشعار التشغيل التلقائي
        function showAutoPlayNotification() {
            // إزالة الإشعارات السابقة
            const existingNotification = document.querySelector('.auto-play-notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            const notification = document.createElement('div');
            notification.className = 'auto-play-notification';
            notification.innerHTML = `
                <i class="bi bi-play-circle me-2"></i>
                تم تشغيل السورة تلقائياً
            `;

            // إدراج الإشعار في بداية المحتوى الرئيسي
            const mainContent = document.querySelector('.main-content');
            mainContent.insertBefore(notification, mainContent.firstChild);

            // إزالة الإشعار بعد 3 ثوان
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 3000);
        }

        // إظهار إشعار الانتقال التلقائي للسورة التالية
        function showNextSurahNotification(surahNumber, surahName) {
            // إزالة الإشعارات السابقة
            const existingNotification = document.querySelector('.next-surah-notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            const notification = document.createElement('div');
            notification.className = 'next-surah-notification';
            notification.innerHTML = `
                <i class="bi bi-arrow-right-circle me-2"></i>
                تم الانتقال تلقائياً إلى ${surahName}
            `;

            // إدراج الإشعار في بداية المحتوى الرئيسي
            const mainContent = document.querySelector('.main-content');
            mainContent.insertBefore(notification, mainContent.firstChild);

            // إزالة الإشعار بعد 4 ثوان
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 4000);
        }

        // function renderAyahList() { // Removed as per edit hint
        //     ayahListEl.innerHTML = ayahs.map((a, i) => {
        //         const sajda = a.sajda ? ' • سجدة' : '';
        //         return `<li class="item" data-idx="${i}"><b>${a.numberInSurah}</b> — ${a.text}<span style="color:var(--text-muted)">${sajda}</span></li>`;
        //     }).join('');
        // }

        // ayahListEl.addEventListener('click', (e) => { // Removed as per edit hint
        //     const li = e.target.closest('.item');
        //     if (!li) return;
        //     const idx = Number(li.dataset.idx);
        //     playAyah(idx);
        // });

        function highlightAyah(idx, { center = true } = {}) {
            // document.querySelectorAll('.ayah-list .item').forEach((el, i) => { // Removed as per edit hint
            //     el.classList.toggle('active', i === idx);
            // });
            const a = ayahs[idx];
            if (!a) return;
            currentAyah.textContent = a.text;
            ayahMeta.textContent = `الآية ${a.numberInSurah} — ${idx + 1}/${ayahs.length}`;

            // جلب الترجمة والتفسير للآية الحالية
            loadAyahTafsir(idx + 1);

            if (center) {
                // const el = document.querySelector(`.ayah-list .item[data-idx="${idx}"]`); // Removed as per edit hint
                // if (el) { el.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
            }
        }

        // جلب التفسير للآية
        async function loadAyahTafsir(ayahNumber) {
            const surahNumber = surahSelect.value;
            if (!surahNumber || !ayahNumber) return;

            try {
                // جلب التفسير العربي
                const tafsirUrl = `https://api.alquran.cloud/v1/ayah/${surahNumber}:${ayahNumber}/ar.muyassar`;
                const tafsirRes = await fetch(tafsirUrl);
                const tafsirData = await tafsirRes.json();

                if (tafsirData.status === 'OK') {
                    tafsirText.textContent = tafsirData.data.text;
                } else {
                    tafsirText.textContent = 'غير متوفر حالياً';
                }

            } catch (error) {
                console.error('خطأ في جلب التفسير:', error);
                tafsirText.textContent = 'خطأ في التحميل';
            }
        }

        function setPlayingUI(isPlaying) {
            const playIcon = document.getElementById('playIcon');
            if (playIcon) {
                playIcon.className = isPlaying ? 'bi bi-pause-fill' : 'bi bi-play-fill';
            }
            playPauseBtn.innerHTML = isPlaying ?
                '<i class="bi bi-pause-fill"></i> إيقاف مؤقت' :
                '<i class="bi bi-play-fill"></i> تشغيل';
            playStatus.textContent = isPlaying ? 'يتم التشغيل…' : 'متوقف';
        }

        function playAyah(idx) {
            if (idx < 0 || idx >= ayahs.length) return;
            currentAyahIndex = idx;
            const a = ayahs[idx];
            audioEl.src = a.audio;
            audioEl.play().then(() => {
                setPlayingUI(true);
                highlightAyah(idx);
            }).catch(err => {
                console.error(err);
                playStatus.textContent = 'لم يبدأ التشغيل. قد يمنع المتصفح التشغيل التلقائي — اضغط تشغيل يدويًا.';
            });
        }

        function playNext() {
            const next = currentAyahIndex + 1;
            if (next < ayahs.length) {
                playAyah(next);
            } else {
                // السورة انتهت، ابحث عن السورة التالية
                const currentSurahNumber = Number(surahSelect.value);
                const nextSurahNumber = currentSurahNumber + 1;

                if (nextSurahNumber <= 114) {
                    // تحميل السورة التالية وتشغيلها تلقائياً
                    const nextSurah = surahs.find(s => s.number === nextSurahNumber);
                    surahSelect.value = nextSurahNumber;
                    selectSurah(nextSurahNumber, true);
                    playStatus.textContent = `تم الانتقال تلقائياً إلى السورة ${nextSurahNumber}`;
                    if (nextSurah) {
                        showNextSurahNotification(nextSurahNumber, nextSurah.name);
                    }
                } else {
                    // وصلنا لآخر سورة، نعود للفاتحة
                    const firstSurah = surahs.find(s => s.number === 1);
                    surahSelect.value = '1';
                    selectSurah(1, true);
                    playStatus.textContent = 'تم العودة للفاتحة تلقائياً';
                    if (firstSurah) {
                        showNextSurahNotification(1, firstSurah.name);
                    }
                }
            }
        }

        function playPrev() {
            const prev = Math.max(0, currentAyahIndex - 1);
            playAyah(prev);
        }

        // أحداث الأزرار
        playPauseBtn.addEventListener('click', () => {
            if (!ayahs.length) {
                selectSurah(Number(surahSelect.value || 1), true);
                return;
            }
            if (audioEl.paused) {
                audioEl.play().then(() => setPlayingUI(true));
            } else {
                audioEl.pause();
                setPlayingUI(false);
            }
        });
        nextBtn.addEventListener('click', playNext);
        prevBtn.addEventListener('click', playPrev);

        // الانتقال التلقائي عند نهاية الآية
        audioEl.addEventListener('ended', playNext);

        // اختصارات لوحة المفاتيح: Space تشغيل/إيقاف، الأسهم يمين/يسار للتنقل
        window.addEventListener('keydown', (e) => {
            if (e.code === 'Space') { e.preventDefault(); playPauseBtn.click(); }
            if (e.code === 'ArrowRight') { playNext(); }
            if (e.code === 'ArrowLeft') { playPrev(); }
        });

        // ====== Theme Management ======
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);

            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const themeIcon = document.getElementById('themeIcon');
            if (themeIcon) {
                if (theme === 'dark') {
                    themeIcon.className = 'bi bi-sun-fill';
                    themeIcon.title = 'الوضع النهاري';
                } else {
                    themeIcon.className = 'bi bi-moon-fill';
                    themeIcon.title = 'الوضع المظلم';
                }
            }
        }

        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = savedTheme === 'auto' ? (prefersDark ? 'dark' : 'light') : savedTheme;

            document.documentElement.setAttribute('data-theme', theme);
            updateThemeIcon(theme);
        }

        // ====== Sidebar Management ======
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.sidebar-overlay');

            if (sidebar.classList.contains('show')) {
                // Hide sidebar
                sidebar.classList.remove('show');
                overlay.classList.remove('show');
                document.body.style.overflow = '';
            } else {
                // Show sidebar
                sidebar.classList.add('show');
                overlay.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
        }

        // Close sidebar when clicking on a link
        document.querySelectorAll('.sidebar .sidebar-nav-item a').forEach(link => {
            link.addEventListener('click', () => {
                toggleSidebar();
            });
        });

        // Close sidebar with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const sidebar = document.getElementById('sidebar');
                if (sidebar.classList.contains('show')) {
                    toggleSidebar();
                }
            }
        });

        // ====== Tafsir Management ======
        function toggleTafsir() {
            const tafsirSection = document.querySelector('.ayah-details .tafsir-section');
            const showTafsirMainBtn = document.getElementById('showTafsirMain');

            if (tafsirSection) {
                if (isTafsirVisible) {
                    tafsirSection.style.display = 'none';
                    // تحديث زر التفسير في الهيدر
                    if (showTafsirMainBtn) {
                        showTafsirMainBtn.classList.remove('btn-secondary');
                        showTafsirMainBtn.classList.add('btn-outline-secondary');
                    }
                } else {
                    tafsirSection.style.display = 'block';
                    // تحديث زر التفسير في الهيدر
                    if (showTafsirMainBtn) {
                        showTafsirMainBtn.classList.remove('btn-outline-secondary');
                        showTafsirMainBtn.classList.add('btn-secondary');
                    }
                }
                isTafsirVisible = !isTafsirVisible;
            }
        }

        // تهيئة الواجهة
        initializeTheme();
        initReciters();
        loadSurahs().then(() => {
            // اختر افتراضيًا الفاتحة
            surahSelect.value = '1';
            // لا تشغل تلقائياً عند التحميل الأولي
            selectSurah(1, false);
        });
    </script>

    <!-- Bottom Navigation Bar - Mobile Only -->
    <nav class="bottom-navbar">

        <div class="nav-item" onclick="window.location.href='index.html'">
            <i class="bi bi-house-door"></i>
            <span>الرئيسية</span>
        </div>


        <div class="nav-item" onclick="window.location.href='prayer-qibla.html'">
            <i class="bi bi-clock"></i>
            <span>الصلاة</span>
        </div>

        <div class="nav-item active" onclick="window.location.href='player.html'">
            <i class="bi bi-book-half"></i>
            <span>القرآن</span>
        </div>


        <div class="nav-item" onclick="window.location.href='hadith.html'">
            <i class="bi bi-chat-quote"></i>
            <span>الأحاديث</span>
        </div>

        <div class="nav-item more-btn" onclick="toggleSidebar()">
            <i class="bi bi-three-dots"></i>
            <span>المزيد</span>
        </div>
    </nav>

    <!-- Enhanced Sidebar (Hidden by default) -->
    <div class="sidebar enhanced-sidebar" id="sidebar" style="display: none;">
        <div class="sidebar-header">
            <div class="logo-section">

                <h4 class="app-name">Quran Cast</h4>
            </div>

        </div>
        <div class="sidebar-content">
            <div class="nav-section mb-4">
                <h6 class="nav-section-title">القائمة الرئيسية</h6>
                <a href="index.html" class="sidebar-nav-item">
                    <i class="bi bi-book-open"></i>
                    <span>القرآن الكريم</span>
                    <i class="bi bi-chevron-left"></i>
                </a>
                <a href="prayer-qibla.html" class="sidebar-nav-item">
                    <i class="bi bi-clock"></i>
                    <span>الصلاة والقبلة</span>
                    <i class="bi bi-chevron-left"></i>
                </a>
                <a href="hadith.html" class="sidebar-nav-item">
                    <i class="bi bi-chat-quote"></i>
                    <span>الأحاديث</span>
                    <i class="bi bi-chevron-left"></i>
                </a>
                <a href="reading.html" class="sidebar-nav-item">
                    <i class="bi bi-book"></i>
                    <span>القراءة</span>
                    <i class="bi bi-chevron-left"></i>
                </a>
                <a href="player.html" class="sidebar-nav-item active">
                    <i class="bi bi-ear"></i>
                    <span>المشغل</span>
                    <i class="bi bi-chevron-left"></i>
                </a>
            </div>

            <div class="nav-section mb-4">
                <h6 class="nav-section-title">إعدادات سريعة</h6>
                <button class="sidebar-nav-item" onclick="toggleTheme()">
                    <i class="bi bi-moon-stars"></i>
                    <span>تبديل الوضع</span>
                    <i class="bi bi-chevron-left"></i>
                </button>
            </div>


            <div class="nav-section mb-4">

                <button style="background-color: rgba(197, 7, 7, 0.212); " class="sidebar-nav-item"
                    onclick="toggleSidebar()">
                    <span> اغلاق</span>
                    <i class="bi bi-chevron-left"></i>
                </button>
            </div>



        </div>
    </div>

    <!-- Quran Mode Selection Modal -->
    <div class="modal fade" id="quranModeModal" tabindex="-1" aria-labelledby="quranModeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0 pb-0">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center pb-4">
                    <div class="quran-mode-icon mb-4">
                        <i class="bi bi-book-open display-1 text-primary"></i>
                    </div>
                    <h4 class="modal-title mb-4" id="quranModeModalLabel">اختر وضع القرآن الكريم</h4>

                    <div class="row g-3">
                        <div class="col-6">
                            <div class="quran-mode-option" onclick="selectQuranMode('listening')">
                                <div class="mode-icon mb-3">
                                    <i class="bi bi-ear display-4 text-success"></i>
                                </div>
                                <h5 class="mode-title">الاستماع</h5>
                                <p class="mode-description text-muted">استمع إلى تلاوات عطرة</p>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="quran-mode-option" onclick="selectQuranMode('reading')">
                                <div class="mode-icon mb-3">
                                    <i class="bi bi-book display-4 text-info"></i>
                                </div>
                                <h5 class="mode-title">القراءة</h5>
                                <p class="mode-description text-muted">اقرأ القرآن مع التفسير</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Quran Mode Selection Functions
        function selectQuranMode(mode) {
            if (mode === 'listening') {
                window.location.href = 'player.html';
            } else if (mode === 'reading') {
                window.location.href = 'reading.html';
            }
        }

        // Show Quran Mode Modal for Quran-related navigation items
        function showQuranModeModal() {
            const modal = new bootstrap.Modal(document.getElementById('quranModeModal'));
            modal.show();
        }

        // Add click event listeners to Quran navigation items
        document.addEventListener('DOMContentLoaded', function () {
            // Desktop navbar Quran link
            const desktopQuranLink = document.querySelector('.navbar-nav .nav-item a[href="player.html"]');
            if (desktopQuranLink) {
                desktopQuranLink.addEventListener('click', function (e) {
                    e.preventDefault();
                    showQuranModeModal();
                });
            }

            // Top navbar Quran item
            const bottomQuranItem = document.querySelector('.bottom-navbar .nav-item[onclick*="player.html"]');
            if (bottomQuranItem) {
                bottomQuranItem.setAttribute('onclick', 'showQuranModeModal()');
            }

            // Sidebar Quran link
            const sidebarQuranLink = document.querySelector('.sidebar .sidebar-nav-item[href="player.html"]');
            if (sidebarQuranLink) {
                sidebarQuranLink.addEventListener('click', function (e) {
                    e.preventDefault();
                    showQuranModeModal();
                });
            }
        });
    </script>
</body>

</html>